<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KMA.Shield - H·ªá Th·ªëng Ph√≤ng Th·ªß S·ªë</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">
    
    <!-- DESIGN SYSTEM: KMA SEC OPS -->
    <style>
        :root {
            --primary-bg: #0f172a; /* Slate 900 */
            --card-bg: #1e293b;    /* Slate 800 */
            --accent: #0ea5e9;     /* Sky 500 */
            --danger: #ef4444;
            --success: #10b981;
        }
        body { font-family: 'Inter', sans-serif; background-color: var(--primary-bg); color: #e2e8f0; }
        .font-mono { font-family: 'JetBrains Mono', monospace; }

        /* Custom UI Components */
        .cyber-card { 
            background: rgba(30, 41, 59, 0.7); 
            border: 1px solid rgba(148, 163, 184, 0.1); 
            backdrop-filter: blur(12px);
            transition: all 0.3s ease;
        }
        .cyber-card:hover { 
            border-color: var(--accent); 
            box-shadow: 0 0 15px rgba(14, 165, 233, 0.15);
        }

        .nav-btn { 
            position: relative; 
            padding: 0.75rem 1.5rem; 
            font-weight: 600; 
            transition: all 0.3s; 
            color: #94a3b8;
        }
        .nav-btn::after {
            content: ''; position: absolute; bottom: 0; left: 50%; width: 0; height: 2px; 
            background: var(--accent); transition: all 0.3s; transform: translateX(-50%);
        }
        .nav-btn.active { color: white; }
        .nav-btn.active::after { width: 80%; }

        /* Scan Terminal Effect */
        .terminal-window {
            background: #020617;
            border: 1px solid #334155;
            box-shadow: 0 20px 50px rgba(0,0,0,0.5);
        }

        /* Animations */
        .fade-in { animation: fadeIn 0.5s ease-out forwards; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        .scan-line {
            width: 100%; height: 2px; background: var(--accent);
            position: absolute; top: 0; left: 0;
            animation: scan 2s linear infinite;
            display: none;
            box-shadow: 0 0 10px var(--accent);
        }
        .scanning .scan-line { display: block; }
        @keyframes scan { 0% { top: 0; opacity: 0; } 50% { opacity: 1; } 100% { top: 100%; opacity: 0; } }

        /* Modal */
        .modal-overlay { background: rgba(0,0,0,0.8); backdrop-filter: blur(4px); }
    </style>
</head>
<body class="flex flex-col min-h-screen selection:bg-sky-500 selection:text-white">

    <!-- Top Security Bar -->
    <div class="bg-black text-[10px] sm:text-xs py-1.5 border-b border-slate-800">
        <div class="max-w-7xl mx-auto px-4 flex justify-between items-center text-slate-400">
            <div class="flex items-center gap-4">
                <span class="text-green-500 font-bold animate-pulse">‚óè SYSTEM ONLINE</span>
                <span class="hidden sm:inline">Encrypted Connection</span>
            </div>
            <div class="flex items-center gap-4">
                <span class="flex items-center gap-1 cursor-help" title="T·ªëi ∆∞u nƒÉng l∆∞·ª£ng t√≠nh to√°n">üåø Green AI Mode: Active</span>
                <span class="text-yellow-500">‚ö† Phi√™n b·∫£n Beta (v2.4 Smart Logic)</span>
            </div>
        </div>
    </div>

    <!-- Navigation -->
    <nav class="sticky top-0 z-40 border-b border-slate-800 bg-[#0f172a]/90 backdrop-blur-md">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16 items-center">
                <!-- Logo -->
                <div class="flex items-center gap-3 cursor-pointer group" onclick="switchTab('scanner')">
                    <div class="w-10 h-10 bg-gradient-to-br from-sky-600 to-indigo-700 rounded-lg flex items-center justify-center shadow-lg group-hover:shadow-sky-500/50 transition">
                        <span class="text-2xl">üõ°Ô∏è</span>
                    </div>
                    <div class="leading-none">
                        <div class="text-xl font-black text-white tracking-wider">KMA<span class="text-sky-500">.SHIELD</span></div>
                        <div class="text-[10px] text-slate-500 uppercase tracking-[0.2em]">Cyber Defense Unit</div>
                    </div>
                </div>
                
                <!-- Desktop Menu -->
                <div class="hidden md:flex space-x-1">
                    <button onclick="switchTab('scanner')" class="nav-btn active" id="btn-scanner">AI SCANNER</button>
                    <button onclick="switchTab('knowledge')" class="nav-btn" id="btn-knowledge">KHO D·ªÆ LI·ªÜU</button>
                    <button onclick="switchTab('legal')" class="nav-btn" id="btn-legal">TH∆Ø VI·ªÜN LU·∫¨T</button>
                    <button onclick="switchTab('about')" class="nav-btn" id="btn-about">V·ªÄ CH√öNG T√îI</button>
                </div>

                <!-- API Settings -->
                <button onclick="toggleSettings()" class="text-slate-400 hover:text-white transition p-2 border border-slate-700 rounded-lg hover:border-sky-500 flex items-center gap-2 text-sm">
                    <span id="key-status-dot" class="w-2 h-2 rounded-full bg-red-500"></span>
                    <span>C·∫•u h√¨nh API</span>
                </button>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="flex-grow w-full max-w-7xl mx-auto p-4 sm:p-6 lg:p-8 space-y-8">

        <!-- TAB 1: AI SCANNER (THE CORE) -->
        <div id="tab-scanner" class="tab-content fade-in block">
            <div class="text-center mb-8">
                <h1 class="text-3xl md:text-5xl font-bold text-white mb-4">H·ªá Th·ªëng Ph√¢n T√≠ch L·ª´a ƒê·∫£o <span class="text-sky-500">AI-Driven</span></h1>
                <p class="text-slate-400 max-w-2xl mx-auto">S·ª≠ d·ª•ng m√¥ h√¨nh ng√¥n ng·ªØ l·ªõn ƒë·ªÉ b√≥c t√°ch c√°c ƒë√≤n t√¢m l√Ω, k·ªπ thu·∫≠t Deepfake v√† d·∫•u hi·ªáu l·ª´a ƒë·∫£o trong vƒÉn b·∫£n theo th·ªùi gian th·ª±c.</p>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-12 gap-6 h-auto lg:h-[600px]">
                
                <!-- Terminal Input -->
                <div class="lg:col-span-7 flex flex-col h-full">
                    <div class="terminal-window rounded-t-xl p-3 flex items-center gap-2 border-b border-slate-700 bg-slate-900">
                        <div class="flex gap-1.5">
                            <div class="w-3 h-3 rounded-full bg-red-500"></div>
                            <div class="w-3 h-3 rounded-full bg-yellow-500"></div>
                            <div class="w-3 h-3 rounded-full bg-green-500"></div>
                        </div>
                        <div class="ml-4 text-xs font-mono text-slate-500">user@kma-shield:~/scanner/input</div>
                        <div class="ml-auto text-[10px] text-sky-500 border border-sky-900 px-2 py-0.5 rounded bg-sky-900/20">NO-LOG POLICY ACTIVE</div>
                    </div>
                    <div class="flex-grow relative bg-[#020617] border-x border-b border-slate-700 rounded-b-xl p-4">
                        <textarea id="scan-input" class="w-full h-full bg-transparent text-slate-300 font-mono text-sm outline-none resize-none placeholder-slate-600" 
                        placeholder="// Nh·∫≠p n·ªôi dung email, tin nh·∫Øn ho·∫∑c k·ªãch b·∫£n cu·ªôc g·ªçi v√†o ƒë√¢y...&#10;// V√≠ d·ª•: 'Ch√†o b·∫°n, m√¨nh l√† nh√¢n vi√™n s√†n X, b·∫°n c√≥ mu·ªën ki·∫øm 500k/ng√†y kh√¥ng?'"></textarea>
                        
                        <!-- Quick Actions -->
                        <div class="absolute bottom-4 left-4 right-4 flex justify-between items-center">
                            <div class="flex gap-2">
                                <button onclick="fillSample(1)" class="text-xs text-slate-500 hover:text-sky-400 transition bg-slate-800 px-2 py-1 rounded border border-slate-700">M·∫´u: Deepfake Voice</button>
                                <button onclick="fillSample(2)" class="text-xs text-slate-500 hover:text-sky-400 transition bg-slate-800 px-2 py-1 rounded border border-slate-700">M·∫´u: OTP Chu·∫©n</button>
                            </div>
                            <button onclick="runScanner()" id="btn-scan" class="bg-sky-600 hover:bg-sky-500 text-white px-6 py-2 rounded font-bold shadow-lg shadow-sky-900/50 transition flex items-center gap-2 group">
                                <span class="group-hover:tracking-wider transition-all">KH·ªûI CH·∫†Y QU√âT</span>
                                <span class="hidden group-hover:inline">_</span>
                            </button>
                        </div>
                        <div id="scan-loader" class="absolute top-0 left-0 w-full h-full bg-black/50 backdrop-blur-sm z-10 hidden flex-col items-center justify-center scanning">
                            <div class="scan-line"></div>
                            <div class="text-sky-400 font-mono text-sm animate-pulse">>> ANALYZING PATTERNS...</div>
                        </div>
                    </div>
                </div>

                <!-- Analysis Output -->
                <div class="lg:col-span-5 flex flex-col h-full">
                    <div class="cyber-card rounded-xl p-6 h-full flex flex-col relative overflow-hidden">
                        <!-- Decorative BG -->
                        <div class="absolute -top-10 -right-10 w-40 h-40 bg-sky-500/10 rounded-full blur-3xl"></div>

                        <!-- Empty State -->
                        <div id="result-empty" class="flex-grow flex flex-col items-center justify-center text-slate-600 text-center">
                            <div class="text-6xl mb-4 opacity-20">üõ°Ô∏è</div>
                            <p class="font-mono text-sm">STATUS: IDLE</p>
                            <p class="text-xs mt-2">ƒêang ch·ªù d·ªØ li·ªáu ƒë·∫ßu v√†o...</p>
                        </div>

                        <!-- Active Result -->
                        <div id="result-active" class="hidden h-full flex flex-col gap-4 relative z-10">
                            <!-- Score Header -->
                            <div class="flex justify-between items-start border-b border-slate-700 pb-4">
                                <div>
                                    <div class="text-xs text-slate-400 uppercase tracking-widest font-bold">M·ª©c ƒë·ªô r·ªßi ro</div>
                                    <div id="risk-level" class="text-2xl font-black text-white mt-1">--</div>
                                </div>
                                <div class="text-right">
                                    <div class="text-xs text-slate-400 uppercase tracking-widest font-bold">ƒêi·ªÉm s·ªë AI</div>
                                    <div id="risk-score" class="text-4xl font-mono font-bold text-white">0</div>
                                </div>
                            </div>

                            <!-- Meter -->
                            <div class="w-full bg-slate-800 h-2 rounded-full overflow-hidden">
                                <div id="risk-bar" class="h-full bg-slate-500 transition-all duration-1000 w-0"></div>
                            </div>

                            <!-- Flags -->
                            <div class="flex-grow overflow-y-auto pr-2 space-y-3 custom-scrollbar">
                                <div class="bg-slate-800/50 border border-slate-700 p-3 rounded-lg">
                                    <h4 class="text-xs font-bold text-sky-400 uppercase mb-2">üö© K·∫øt qu·∫£ ph√¢n t√≠ch</h4>
                                    <ul id="flag-list" class="text-sm text-slate-300 space-y-2 list-disc pl-4"></ul>
                                </div>
                                <div class="bg-blue-500/10 border border-blue-500/20 p-3 rounded-lg">
                                    <h4 class="text-xs font-bold text-blue-400 uppercase mb-2">üí° L·ªùi khuy√™n & Ng·ªØ c·∫£nh</h4>
                                    <p id="advice-text" class="text-sm text-slate-300"></p>
                                </div>
                            </div>
                            
                            <div class="text-[10px] text-slate-500 text-center pt-2">
                                * K·∫øt qu·∫£ ph√¢n t√≠ch b·ªüi Gemini AI.
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- TAB 2: KNOWLEDGE BASE -->
        <div id="tab-knowledge" class="tab-content hidden fade-in">
            <h2 class="text-3xl font-bold text-white mb-8 border-l-4 border-sky-500 pl-4">D·ªØ Li·ªáu M·ªëi ƒêe D·ªça</h2>
            
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- Deepfake -->
                <div class="cyber-card p-6 rounded-xl hover:bg-slate-800/80 cursor-default group">
                    <div class="text-4xl mb-4 group-hover:scale-110 transition">üé≠</div>
                    <h3 class="text-xl font-bold text-white mb-2">Deepfake & GANs</h3>
                    <p class="text-sm text-slate-400 mb-4 text-justify">
                        S·ª≠ d·ª•ng m·∫°ng ƒë·ªëi kh√°ng sinh (GANs) g·ªìm Generator (T·∫°o ·∫£nh gi·∫£) v√† Discriminator (Ph√°t hi·ªán ·∫£nh gi·∫£) ƒë·∫•u tr√≠ li√™n t·ª•c ƒë·ªÉ t·∫°o ra video/gi·ªçng n√≥i y nh∆∞ th·∫≠t.
                    </p>
                    <div class="bg-black/30 p-3 rounded border border-slate-700">
                        <span class="text-xs text-red-400 font-bold block mb-1">D·∫•u hi·ªáu nh·∫≠n bi·∫øt:</span>
                        <ul class="text-xs text-slate-500 list-disc pl-4 space-y-1">
                            <li>M·∫Øt ch·ªõp kh√¥ng t·ª± nhi√™n ho·∫∑c kh√¥ng ch·ªõp.</li>
                            <li>Kh·∫©u h√¨nh mi·ªáng v√† √¢m thanh b·ªã l·ªách (Lip-sync error).</li>
                            <li>√Ånh s√°ng tr√™n khu√¥n m·∫∑t kh√¥ng kh·ªõp v·ªõi n·ªÅn.</li>
                        </ul>
                    </div>
                </div>

                <!-- Phishing -->
                <div class="cyber-card p-6 rounded-xl hover:bg-slate-800/80 cursor-default group">
                    <div class="text-4xl mb-4 group-hover:scale-110 transition">üé£</div>
                    <h3 class="text-xl font-bold text-white mb-2">Spear Phishing (AI)</h3>
                    <p class="text-sm text-slate-400 mb-4 text-justify">
                        T·∫•n c√¥ng gi·∫£ m·∫°o c√≥ ch·ªß ƒë√≠ch. Hacker d√πng AI ƒë·ªÉ thu th·∫≠p th√¥ng tin c·ªßa b·∫°n tr√™n MXH, sau ƒë√≥ so·∫°n email c√° nh√¢n h√≥a cao, kh√¥ng c√≤n l·ªói ch√≠nh t·∫£ nh∆∞ tr∆∞·ªõc.
                    </p>
                    <div class="bg-black/30 p-3 rounded border border-slate-700">
                        <span class="text-xs text-red-400 font-bold block mb-1">Chi·∫øn thu·∫≠t m·ªõi:</span>
                        <ul class="text-xs text-slate-500 list-disc pl-4 space-y-1">
                            <li><strong>Quishing:</strong> G·ª≠i m√£ QR ƒë·ªôc h·∫°i ƒë·ªÉ n√© b·ªô l·ªçc email.</li>
                            <li><strong>Brand Impersonation:</strong> Gi·∫£ m·∫°o th√¥ng b√°o ng√¢n h√†ng/ch√≠nh ph·ªß.</li>
                        </ul>
                    </div>
                </div>

                <!-- Malware -->
                <div class="cyber-card p-6 rounded-xl hover:bg-slate-800/80 cursor-default group">
                    <div class="text-4xl mb-4 group-hover:scale-110 transition">ü¶†</div>
                    <h3 class="text-xl font-bold text-white mb-2">Malware & RATs</h3>
                    <p class="text-sm text-slate-400 mb-4 text-justify">
                        M√£ ƒë·ªôc truy c·∫≠p t·ª´ xa (RAT) th∆∞·ªùng n√∫p b√≥ng d∆∞·ªõi d·∫°ng ·ª©ng d·ª•ng "D·ªãch v·ª• c√¥ng", "Ho√†n thu·∫ø". Khi c√†i ƒë·∫∑t, hacker chi·∫øm quy·ªÅn ki·ªÉm so√°t ƒëi·ªán tho·∫°i.
                    </p>
                    <div class="bg-black/30 p-3 rounded border border-slate-700">
                        <span class="text-xs text-red-400 font-bold block mb-1">Ph√≤ng tr√°nh:</span>
                        <ul class="text-xs text-slate-500 list-disc pl-4 space-y-1">
                            <li>Tuy·ªát ƒë·ªëi kh√¥ng c√†i file .APK t·ª´ ngu·ªìn l·∫° (Zalo/Telegram).</li>
                            <li>Lu√¥n b·∫≠t Google Play Protect.</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- TAB 3: LEGAL LIBRARY -->
        <div id="tab-legal" class="tab-content hidden fade-in">
            <h2 class="text-3xl font-bold text-white mb-8 border-l-4 border-green-500 pl-4">Th∆∞ Vi·ªán Ph√°p L√Ω S·ªë</h2>
            
            <div class="space-y-6">
                <!-- B·ªô Lu·∫≠t H√¨nh S·ª± -->
                <div class="cyber-card rounded-xl overflow-hidden">
                    <div class="bg-slate-800/50 p-4 border-b border-slate-700 flex justify-between items-center">
                        <h3 class="font-bold text-lg text-white">B·ªô Lu·∫≠t H√¨nh S·ª± 2015 (S·ª≠a ƒë·ªïi 2017)</h3>
                        <span class="bg-red-500/20 text-red-400 text-xs px-2 py-1 rounded font-bold uppercase">Ch·∫ø t√†i cao nh·∫•t</span>
                    </div>
                    <div class="p-6 grid gap-6 md:grid-cols-2">
                        <div>
                            <h4 class="text-sky-400 font-bold font-mono mb-2">ƒêi·ªÅu 174. T·ªôi l·ª´a ƒë·∫£o chi·∫øm ƒëo·∫°t t√†i s·∫£n</h4>
                            <p class="text-sm text-slate-400 mb-2 text-justify">Ng∆∞·ªùi n√†o b·∫±ng th·ªß ƒëo·∫°n gian d·ªëi chi·∫øm ƒëo·∫°t t√†i s·∫£n c·ªßa ng∆∞·ªùi kh√°c tr·ªã gi√° t·ª´ 2.000.000 ƒë·ªìng tr·ªü l√™n.</p>
                            <ul class="text-xs text-slate-500 space-y-1 list-disc pl-4">
                                <li>Ph·∫°t c·∫£i t·∫°o kh√¥ng giam gi·ªØ ƒë·∫øn 03 nƒÉm.</li>
                                <li>Ph·∫°t t√π t·ª´ 12 nƒÉm ƒë·∫øn <strong>20 nƒÉm ho·∫∑c t√π chung th√¢n</strong> (N·∫øu chi·∫øm ƒëo·∫°t >= 500 tri·ªáu ƒë·ªìng).</li>
                                <li>Ph·∫°t ti·ªÅn t·ª´ 10.000.000 ƒë·∫øn 100.000.000 ƒë·ªìng.</li>
                            </ul>
                        </div>
                        <div>
                            <h4 class="text-sky-400 font-bold font-mono mb-2">ƒêi·ªÅu 290. T·ªôi s·ª≠ d·ª•ng m·∫°ng m√°y t√≠nh...</h4>
                            <p class="text-sm text-slate-400 mb-2 text-justify">S·ª≠ d·ª•ng m·∫°ng m√°y t√≠nh, m·∫°ng vi·ªÖn th√¥ng, ph∆∞∆°ng ti·ªán ƒëi·ªán t·ª≠ th·ª±c hi·ªán h√†nh vi chi·∫øm ƒëo·∫°t t√†i s·∫£n.</p>
                            <ul class="text-xs text-slate-500 space-y-1 list-disc pl-4">
                                <li>Ph·∫°t t√π t·ª´ 07 nƒÉm ƒë·∫øn <strong>15 nƒÉm</strong> (N·∫øu chi·∫øm ƒëo·∫°t >= 500 tri·ªáu ƒë·ªìng).</li>
                                <li>C·∫•m h√†nh ngh·ªÅ ho·∫∑c l√†m c√¥ng vi·ªác nh·∫•t ƒë·ªãnh t·ª´ 01-05 nƒÉm.</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- Ngh·ªã ƒë·ªãnh -->
                <div class="grid md:grid-cols-2 gap-6">
                    <div class="cyber-card rounded-xl p-6">
                        <div class="flex items-center gap-2 mb-4">
                            <span class="text-2xl">üîí</span>
                            <h3 class="font-bold text-white">Ngh·ªã ƒë·ªãnh 13/2023/Nƒê-CP</h3>
                        </div>
                        <p class="text-sm text-slate-400 mb-3 text-justify">
                            B·∫£o v·ªá d·ªØ li·ªáu c√° nh√¢n. M·ªçi h√†nh vi thu th·∫≠p, mua b√°n d·ªØ li·ªáu tr√°i ph√©p (nguy√™n li·ªáu cho l·ª´a ƒë·∫£o) ƒë·ªÅu b·ªã x·ª≠ l√Ω nghi√™m.
                        </p>
                        <div class="bg-slate-900/50 p-3 rounded border border-slate-700">
                            <span class="text-xs text-white block mb-1">M·ª©c ph·∫°t:</span>
                            <span class="text-xs text-slate-400">Ph·∫°t ti·ªÅn t·ªõi <strong>5% t·ªïng doanh thu</strong> ƒë·ªëi v·ªõi doanh nghi·ªáp vi ph·∫°m.</span>
                        </div>
                    </div>

                    <div class="cyber-card rounded-xl p-6">
                        <div class="flex items-center gap-2 mb-4">
                            <span class="text-2xl">üìµ</span>
                            <h3 class="font-bold text-white">Ngh·ªã ƒë·ªãnh 91/2020/Nƒê-CP</h3>
                        </div>
                        <p class="text-sm text-slate-400 mb-3 text-justify">
                            Ch·ªëng tin nh·∫Øn r√°c, th∆∞ ƒëi·ªán t·ª≠ r√°c, cu·ªôc g·ªçi r√°c. B·∫£o v·ªá ng∆∞·ªùi d√πng kh·ªèi s·ª± qu·∫•y r·ªëi v√† l·ª´a ƒë·∫£o qua vi·ªÖn th√¥ng.
                        </p>
                        <div class="bg-slate-900/50 p-3 rounded border border-slate-700">
                            <span class="text-xs text-white block mb-1">M·ª©c ph·∫°t:</span>
                            <span class="text-xs text-slate-400">Ph·∫°t t·ª´ <strong>5.000.000 ƒë·∫øn 100.000.000 ƒë·ªìng</strong> t√πy h√†nh vi.</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- TAB 4: ABOUT -->
        <div id="tab-about" class="tab-content hidden fade-in">
             <div class="text-center py-10">
                <h1 class="text-4xl font-bold text-white mb-6">KMA<span class="text-sky-500">.SHIELD</span></h1>
                <p class="text-slate-400 max-w-2xl mx-auto mb-8">
                    D·ª± √°n phi l·ª£i nhu·∫≠n nh·∫±m n√¢ng cao nh·∫≠n th·ª©c an to√†n th√¥ng tin cho c·ªông ƒë·ªìng, l·∫•y c·∫£m h·ª©ng t·ª´ tinh th·∫ßn c·ªßa H·ªçc vi·ªán K·ªπ thu·∫≠t M·∫≠t m√£.
                </p>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 text-left">
                    <div class="cyber-card p-6 rounded-xl">
                        <h4 class="text-white font-bold mb-2">S·ª© m·ªánh</h4>
                        <p class="text-sm text-slate-500">Trang b·ªã "khi√™n s·ªë" cho m·ªçi ng∆∞·ªùi d√¢n Vi·ªát Nam tr∆∞·ªõc l√†n s√≥ng t·ªôi ph·∫°m c√¥ng ngh·ªá cao.</p>
                    </div>
                    <div class="cyber-card p-6 rounded-xl">
                        <h4 class="text-white font-bold mb-2">C√¥ng ngh·ªá</h4>
                        <p class="text-sm text-slate-500">S·ª≠ d·ª•ng Google Gemini 2.5 - M√¥ h√¨nh ng√¥n ng·ªØ t·ªëi ∆∞u cho t·ªëc ƒë·ªô v√† chi ph√≠ th·∫•p (Green AI).</p>
                    </div>
                    <div class="cyber-card p-6 rounded-xl">
                        <h4 class="text-white font-bold mb-2">B·∫£o m·∫≠t</h4>
                        <p class="text-sm text-slate-500">Tu√¢n th·ªß nguy√™n t·∫Øc Privacy-First. Kh√¥ng l∆∞u tr·ªØ log, API Key l∆∞u t·∫°i m√°y ng∆∞·ªùi d√πng.</p>
                    </div>
                </div>
             </div>
        </div>

    </main>

    <!-- Footer with Strict Disclaimer -->
    <footer class="border-t border-slate-800 bg-[#020617] py-8 mt-auto">
        <div class="max-w-5xl mx-auto px-6">
            <div class="flex flex-col items-center text-center space-y-6">
                
                <!-- Disclaimer Box -->
                <div class="w-full bg-red-900/10 border border-red-900/30 p-4 rounded-lg">
                    <h5 class="text-red-500 font-bold text-xs uppercase mb-2">‚ö† TUY√äN B·ªê MI·ªÑN TR·ª™ TR√ÅCH NHI·ªÜM (DISCLAIMER)</h5>
                    <p class="text-[11px] text-slate-400 leading-relaxed text-justify md:text-center">
                        1. <strong>T√≠nh ch·∫•t tham kh·∫£o:</strong> KMA.Shield l√† c√¥ng c·ª• h·ªó tr·ª£ d·ª±a tr√™n ph√¢n t√≠ch x√°c su·∫•t c·ªßa Tr√≠ tu·ªá nh√¢n t·∫°o (AI). AI c√≥ th·ªÉ m·∫Øc sai l·∫ßm (hallucinations). K·∫øt qu·∫£ ph√¢n t√≠ch <strong>tuy·ªát ƒë·ªëi kh√¥ng</strong> ƒë∆∞·ª£c coi l√† l·ªùi khuy√™n ph√°p l√Ω, k·∫øt lu·∫≠n ƒëi·ªÅu tra ch√≠nh th·ª©c hay b·∫±ng ch·ª©ng tr∆∞·ªõc t√≤a.
                        <br>
                        2. <strong>Gi·ªõi h·∫°n tr√°ch nhi·ªám:</strong> ƒê·ªôi ng≈© ph√°t tri·ªÉn kh√¥ng ch·ªãu tr√°ch nhi·ªám ph√°p l√Ω ƒë·ªëi v·ªõi b·∫•t k·ª≥ thi·ªát h·∫°i n√†o (t√†i ch√≠nh, d·ªØ li·ªáu, danh d·ª±) ph√°t sinh t·ª´ vi·ªác ng∆∞·ªùi d√πng tin t∆∞·ªüng tuy·ªát ƒë·ªëi v√†o k·∫øt qu·∫£ c·ªßa c√¥ng c·ª• n√†y.
                        <br>
                        3. <strong>H√†nh ƒë·ªông khuy·∫øn ngh·ªã:</strong> Trong m·ªçi tr∆∞·ªùng h·ª£p nghi ng·ªù l·ª´a ƒë·∫£o, ng∆∞·ªùi d√πng c·∫ßn li√™n h·ªá tr·ª±c ti·∫øp v·ªõi C∆° quan C√¥ng an, Ng√¢n h√†ng ho·∫∑c c√°c t·ªï ch·ª©c li√™n quan ƒë·ªÉ x√°c minh.
                    </p>
                </div>

                <div class="flex gap-6 text-xs text-slate-500 font-mono">
                    <span>¬© 2026 KMA.Shield Project</span>
                    <span>Designed for Cyber Safety</span>
                </div>
            </div>
        </div>
    </footer>

    <!-- Settings Modal -->
    <div id="settings-modal" class="hidden fixed inset-0 modal-overlay z-50 flex items-center justify-center p-4">
        <div class="bg-[#1e293b] rounded-xl shadow-2xl max-w-md w-full p-6 border border-slate-700">
            <h3 class="text-xl font-bold text-white mb-4">‚öôÔ∏è C·∫•u h√¨nh API</h3>
            <p class="text-sm text-slate-400 mb-4">
                N·∫øu b·∫°n g·∫∑p l·ªói Key, vui l√≤ng nh·∫≠p l·∫°i Key m·ªõi v√†o b√™n d∆∞·ªõi.
            </p>
            <div class="space-y-4">
                <div>
                    <label class="block text-xs font-bold text-slate-500 uppercase mb-1">Google Gemini API Key</label>
                    <input type="password" id="input-api-key" class="w-full bg-[#0f172a] border border-slate-600 rounded p-3 text-white text-sm outline-none focus:border-sky-500" placeholder="Paste key b·∫Øt ƒë·∫ßu b·∫±ng AIza...">
                </div>
                <div class="flex justify-between pt-2">
                    <button onclick="clearKey()" class="text-xs text-red-500 hover:underline">X√≥a Key c≈©</button>
                    <div class="flex gap-3">
                        <button onclick="toggleSettings()" class="px-4 py-2 text-sm text-slate-400 hover:text-white hover:bg-slate-700 rounded">ƒê√≥ng</button>
                        <button onclick="saveKey()" class="px-4 py-2 text-sm bg-sky-600 text-white font-bold rounded hover:bg-sky-500">L∆∞u M·ªõi</button>
                    </div>
                </div>
                <p class="text-[10px] text-slate-500 text-center">Ch∆∞a c√≥ key? <a href="https://aistudio.google.com/app/apikey" target="_blank" class="text-sky-500 hover:underline">L·∫•y mi·ªÖn ph√≠ t·∫°i Google AI Studio</a></p>
            </div>
        </div>
    </div>

    <!-- LOGIC -->
    <script>
        // --- CORE LOGIC ---
        
        // Tab Switching
        function switchTab(tabId) {
            document.querySelectorAll('.nav-btn').forEach(btn => btn.classList.remove('active'));
            document.getElementById('btn-' + tabId).classList.add('active');
            
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.add('hidden');
                content.classList.remove('block'); 
            });
            
            const target = document.getElementById('tab-' + tabId);
            target.classList.remove('hidden');
            target.classList.add('block'); 
            
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // Settings & Key Management
        function toggleSettings() {
            const modal = document.getElementById('settings-modal');
            const input = document.getElementById('input-api-key');
            
            if (modal.classList.contains('hidden')) {
                modal.classList.remove('hidden');
                input.value = localStorage.getItem('kma_gemini_key') || '';
            } else {
                modal.classList.add('hidden');
            }
        }

        function saveKey() {
            const key = document.getElementById('input-api-key').value.trim();
            if (key) {
                localStorage.setItem('kma_gemini_key', key);
                checkKeyStatus();
                alert("ƒê√£ l∆∞u API Key m·ªõi!");
                toggleSettings();
            } else {
                alert("Vui l√≤ng nh·∫≠p Key h·ª£p l·ªá.");
            }
        }

        function clearKey() {
            localStorage.removeItem('kma_gemini_key');
            document.getElementById('input-api-key').value = '';
            checkKeyStatus();
            alert("ƒê√£ x√≥a Key c≈©. Vui l√≤ng nh·∫≠p Key m·ªõi.");
        }

        function checkKeyStatus() {
            const hasKey = !!localStorage.getItem('kma_gemini_key');
            const dot = document.getElementById('key-status-dot');
            if (hasKey) {
                dot.classList.remove('bg-red-500');
                dot.classList.add('bg-green-500', 'shadow-[0_0_5px_#22c55e]');
            } else {
                dot.classList.remove('bg-green-500', 'shadow-[0_0_5px_#22c55e]');
                dot.classList.add('bg-red-500');
            }
        }

        // Scanner Logic
        function fillSample(id) {
            const texts = {
                1: "Gi·ªçng n√≥i trong video (gi·ªëng h·ªát con g√°i t√¥i): 'M·∫π ∆°i, con ƒëang ƒëi ph∆∞·ª£t v·ªõi b·∫°n th√¨ b·ªã m·∫•t v√≠ ·ªü tr·∫°m d·ª´ng ch√¢n. M·∫π chuy·ªÉn g·∫•p 5 tri·ªáu v√†o s·ªë t√†i kho·∫£n c·ªßa ch·ªß qu√°n n√†y gi√∫p con nh√©, ƒëi·ªán tho·∫°i con s·∫Øp h·∫øt pin kh√¥ng g·ªçi l·∫°i ƒë∆∞·ª£c ƒë√¢u.'",
                2: "BIDV: Nhap OTP 014778 (hieu luc 5 phut) de XAC NHAN THANH TOAN so tien 12,224,000.00 VND cho giao dich the co ma tham chieu TQE"
            };
            document.getElementById('scan-input').value = texts[id];
        }

        async function runScanner() {
            // 1. Check Key
            const apiKey = localStorage.getItem('kma_gemini_key');
            if (!apiKey) {
                alert("H·ªÜ TH·ªêNG CH∆ØA C√ì KEY.\nVui l√≤ng nh·∫•n n√∫t 'C·∫•u h√¨nh API' v√† nh·∫≠p Gemini Key m·ªõi.");
                toggleSettings();
                return;
            }

            const input = document.getElementById('scan-input').value.trim();
            if (!input) return alert("Vui l√≤ng nh·∫≠p d·ªØ li·ªáu ƒë·ªÉ ph√¢n t√≠ch.");

            // 2. UI Loading
            const btn = document.getElementById('btn-scan');
            const loader = document.getElementById('scan-loader');
            btn.disabled = true;
            btn.classList.add('opacity-50');
            loader.classList.remove('hidden');
            loader.classList.add('flex');

            // 3. Prepare Prompt (IMPROVED FOR SMART CONTEXT)
            const prompt = `
                B·∫°n l√† chuy√™n gia an ninh m·∫°ng KMA. H√£y ph√¢n t√≠ch ƒëo·∫°n vƒÉn b·∫£n sau ƒë·ªÉ ƒë√°nh gi√° r·ªßi ro l·ª´a ƒë·∫£o: "${input}".
                
                QUY T·∫ÆC ƒê√ÅNH GI√Å (R·∫§T QUAN TR·ªåNG):
                1. Tin nh·∫Øn OTP chu·∫©n t·ª´ ng√¢n h√†ng/d·ªãch v·ª• (Brandname, c·∫•u tr√∫c r√µ r√†ng, kh√¥ng ch·ª©a link l·∫°) => AN TO√ÄN (Risk score < 20).
                2. Tin nh·∫Øn th√¥ng b√°o bi·∫øn ƒë·ªông s·ªë d∆∞, giao d·ªãch th√†nh c√¥ng (C·∫•u tr√∫c chu·∫©n) => AN TO√ÄN (Risk score < 20).
                3. Tin nh·∫Øn y√™u c·∫ßu chuy·ªÉn ti·ªÅn g·∫•p, ƒëe d·ªça kh√≥a t√†i kho·∫£n, ho·∫∑c ch·ª©a link l·∫° (bit.ly, t√™n mi·ªÅn kh√¥ng ch√≠nh th·ªëng) => NGUY HI·ªÇM (Risk score > 80).
                4. Tin nh·∫Øn gi·∫£ m·∫°o ng∆∞·ªùi th√¢n (Deepfake voice, chat) y√™u c·∫ßu chuy·ªÉn ti·ªÅn => NGUY HI·ªÇM (Risk score > 80).
                
                Y√™u c·∫ßu tr·∫£ v·ªÅ JSON thu·∫ßn (no markdown):
                {
                    "risk_score": (s·ªë nguy√™n 0-100),
                    "risk_level": "AN TO√ÄN / C·∫¢NH B√ÅO / NGUY HI·ªÇM",
                    "flags": ["Nh·∫≠n x√©t 1 (V·ªÅ c·∫•u tr√∫c tin nh·∫Øn)", "Nh·∫≠n x√©t 2 (V·ªÅ n·ªôi dung/y√™u c·∫ßu)"],
                    "advice": "L·ªùi khuy√™n (L∆∞u √Ω: N·∫øu tin nh·∫Øn l√† An To√†n, h√£y khuy√™n ng∆∞·ªùi d√πng ki·ªÉm tra xem h·ªç c√≥ th·ª±c hi·ªán giao d·ªãch ƒë√≥ kh√¥ng. N·∫øu kh√¥ng, h√£y b√°o kh√≥a th·∫ª)."
                }
            `;

            try {
                // 4. API Call
                const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`;
                const response = await fetch(url, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ contents: [{ parts: [{ text: prompt }] }] })
                });

                if (!response.ok) {
                    const errorData = await response.json();
                    throw new Error(errorData.error.message || "Unknown API Error");
                }

                const data = await response.json();
                const rawText = data.candidates?.[0]?.content?.parts?.[0]?.text;
                
                // 5. Clean & Parse JSON
                let cleanJson = rawText.replace(/```json/g, '').replace(/```/g, '').trim();
                const firstBrace = cleanJson.indexOf('{');
                const lastBrace = cleanJson.lastIndexOf('}');
                if (firstBrace !== -1 && lastBrace !== -1) {
                    cleanJson = cleanJson.substring(firstBrace, lastBrace + 1);
                }

                const result = JSON.parse(cleanJson);
                displayResult(result);

            } catch (e) {
                console.error(e);
                alert(`L·ªñI K·∫æT N·ªêI API:\n${e.message}\n\nVui l√≤ng ki·ªÉm tra l·∫°i Key ho·∫∑c quy·ªÅn truy c·∫≠p c·ªßa Key.`);
            } finally {
                btn.disabled = false;
                btn.classList.remove('opacity-50');
                loader.classList.add('hidden');
                loader.classList.remove('flex');
            }
        }

        function displayResult(data) {
            document.getElementById('result-empty').classList.add('hidden');
            document.getElementById('result-active').classList.remove('hidden');
            document.getElementById('result-active').classList.add('flex'); 

            // Data Mapping
            document.getElementById('risk-score').innerText = data.risk_score;
            document.getElementById('risk-level').innerText = data.risk_level;
            document.getElementById('advice-text').innerText = data.advice;

            // Visuals
            const bar = document.getElementById('risk-bar');
            bar.style.width = data.risk_score + "%";

            // Color Coding
            const scoreDisplay = document.getElementById('risk-score');
            const levelDisplay = document.getElementById('risk-level');
            
            bar.className = "h-full transition-all duration-1000"; 
            
            scoreDisplay.classList.remove('text-red-500', 'text-yellow-500', 'text-green-500');
            levelDisplay.classList.remove('text-red-500', 'text-yellow-500', 'text-green-500');

            if (data.risk_score >= 80) {
                bar.classList.add('bg-red-500', 'shadow-[0_0_10px_#ef4444]');
                scoreDisplay.classList.add('text-red-500');
                levelDisplay.classList.add('text-red-500');
            } else if (data.risk_score >= 40) {
                bar.classList.add('bg-yellow-500');
                scoreDisplay.classList.add('text-yellow-500');
                levelDisplay.classList.add('text-yellow-500');
            } else {
                bar.classList.add('bg-green-500');
                scoreDisplay.classList.add('text-green-500');
                levelDisplay.classList.add('text-green-500');
            }

            // Flags List
            const list = document.getElementById('flag-list');
            list.innerHTML = "";
            data.flags.forEach(flag => {
                const li = document.createElement('li');
                li.innerText = flag;
                list.appendChild(li);
            });
        }

        // Initialize
        checkKeyStatus();
    </script>
</body>
</html>
